new implemenation completed by afra
